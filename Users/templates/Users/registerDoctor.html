{% extends "Users/layout.html" %}

{% block body %}

    <h2>Register</h2>

    {% if message %}
        <div>{{ message }}</div>
    {% endif %}

    <form action="{% url 'registerDoctor' %}" method="post">
        {% csrf_token %}
        <div class="form-group">
            <input class="form-control" autofocus type="email" name="email" placeholder="Email Address">
        </div>
        <div class="form-group">
            <input class="form-control" type="password" name="password" placeholder="Password">
        </div>
        <div class="form-group">
            <input class="form-control" type="password" name="confirmation" placeholder="Confirm Password">
        </div>

        <input type="radio" class="radio" id="patient" name="Type" data-value=1>
        <label for="patient">Patient</label><br>
        <input type="radio" class="radio" id="doctor" name="Type" data-value=2>
        <label for="doctor">Doctor</label><br>

        <div id="form"></div>

    </form>

    Already have an account? <a href="{% url 'login' %}">Log In here.</a>

    <script>
        function showForm(id){
            if(id == 1)
                document.querySelector('form').action = "{% url 'register' %}"
            else
                document.querySelector('form').action = "{% url 'registerDoctor' %}"                

            fetch(`rform/${id}`)
            .then(response => response.text())
            .then(data => {
                document.querySelector('#form').innerHTML = data
            })
        }
        document.addEventListener("DOMContentLoaded", function(){
            document.querySelectorAll('.radio').forEach(function(radio){
                radio.onclick = function(){
                        console.log(this.dataset.value)
                        showForm(this.dataset.value)
                }
            })
        })
    </script>
{% endblock %}